<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USA Population Density & Growth Projector</title>
    <style>
        :root {
            --bg-color: #0f172a; /* Slate 900 */
            --panel-bg: #1e293b; /* Slate 800 */
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --accent-blue: #38bdf8;
            --accent-red: #f43f5e;
            --accent-gold: #fbbf24;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        h1 { margin: 0 0 5px 0; font-weight: 200; letter-spacing: 1px; }
        .subtitle { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 25px; }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }

        @media (max-width: 900px) {
            .dashboard { grid-template-columns: 1fr; }
        }

        /* Canvas Area */
        .map-container {
            background: var(--panel-bg);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            border: 1px solid #334155;
        }

        canvas {
            width: 100%;
            height: auto;
            max-height: 600px;
            cursor: crosshair;
        }

        /* Controls Area */
        .controls-panel {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            border: 1px solid #334155;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }

        .stat-card {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-blue);
        }

        .stat-card.red { border-left-color: var(--accent-red); }
        .stat-card.gold { border-left-color: var(--accent-gold); }

        .stat-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            font-feature-settings: "tnum";
            font-variant-numeric: tabular-nums;
        }

        /* Custom Slider */
        .slider-group { margin-top: auto; }
        
        input[type=range] {
            width: 100%;
            margin: 10px 0;
            -webkit-appearance: none;
            background: transparent;
        }

        input[type=range]::-webkit-slider-track {
            width: 100%;
            height: 6px;
            background: #334155;
            border-radius: 3px;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: var(--accent-blue);
            cursor: pointer;
            margin-top: -9px;
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.5);
            transition: transform 0.1s;
        }

        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }

        .range-labels {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 5px;
        }

    </style>
</head>
<body>

    <h1>Global Density Visualizer</h1>
    <p class="subtitle">Propagating 8 Billion to 10 Trillion people from Los Angeles â€¢ 5.5 sq ft/person</p>

    <div class="dashboard">
        
        <!-- Map Visualization -->
        <div class="map-container">
            <canvas id="usCanvas" width="960" height="600"></canvas>
            
            <!-- Floating Marker Label -->
            <div id="laLabel" style="position: absolute; display: none; background: rgba(0,0,0,0.8); padding: 5px 10px; border-radius: 4px; font-size: 12px; pointer-events: none;">Los Angeles Start</div>
        </div>

        <!-- Data & Controls -->
        <div class="controls-panel">
            
            <div class="stat-card gold">
                <span class="stat-label">Projected Year</span>
                <span id="yearVal" class="stat-value">2025</span>
            </div>

            <div class="stat-card red">
                <span class="stat-label">Total Population</span>
                <span id="popVal" class="stat-value">8.00 Billion</span>
            </div>

            <div class="stat-card">
                <span class="stat-label">Land Area Required</span>
                <span id="areaVal" class="stat-value">1,578 sq mi</span>
            </div>

            <div class="stat-card">
                <span class="stat-label">US Coverage</span>
                <span id="coverageVal" class="stat-value">0.05%</span>
            </div>

            <div class="slider-group">
                <label class="stat-label">Scale Factor</label>
                <input type="range" id="popSlider" min="1" max="1275" step="1" value="1">
                <div class="range-labels">
                    <span>Now (8B)</span>
                    <span>Max (10T)</span>
                </div>
            </div>

        </div>
    </div>

    <script>
        /**
         * CONFIGURATION & CONSTANTS
         * Based on Research:
         * - 8 Billion people @ 5.5 sq ft/person = ~44B sq ft.
         * - 1 sq mile = 27,878,400 sq ft.
         * - 44B / 27.8M = ~1,578 sq miles.
         * - Sqrt(1578) = ~39.7 miles (matches the 40x40 prompt).
         * - US Land Area (Contiguous) = ~3,119,884 sq miles.
         * - Growth Rate = ~0.91% (0.0091) per year.
         */
        const CONFIG = {
            initialPop: 8_000_000_000,
            initialArea: 1578, // Exact calculated area for 8B people
            usLandArea: 3_119_884,
            usWidthMiles: 2800,
            growthRate: 0.0091,
            startYear: 2025
        };

        // DOM Elements
        const canvas = document.getElementById('usCanvas');
        const ctx = canvas.getContext('2d');
        const slider = document.getElementById('popSlider');
        const ui = {
            year: document.getElementById('yearVal'),
            pop: document.getElementById('popVal'),
            area: document.getElementById('areaVal'),
            coverage: document.getElementById('coverageVal')
        };

        // High-Definition Albers Projection Path (Detailed Silhouette)
        const usPathData = "M935.5,59.6l12.1-0.2l2.6-5.6l-12.2-8.1l6.7-20.8l-7.1-2.2l-1.1-9.4l-21.3,5.2l-9.7,18.7l-9.4,1.9l-3.4,4.5l-7.5-1.1l-2.6,4.1l-28.5,7.9l-7.1-3.7l-19.5,3.4l-8.2-0.7l-6-4.5l-5.6,1.9l-10.5-3.7l-3.7,2.6l-29.6-11.2l-9.7,3.7l-33-6.4l-4.5,1.9l-40.1-5.2l-14.2,3.7l-11.2-5.6l-10.5,3.7l-19.8-5.6l-7.1,3l-20.2-4.1l-6.7,2.2l-13.9-3l-11.2,4.1l-14.2-3l-34.1,9.7l-14.2-3l-53.2,15.7l-15.7-1.1l-19.5,5.6l-18.3-0.4l-15.7-3.4l-49.4,12l-20.6,0.4l-10.9-3l-14.2,1.5l-9, -1.9l-2.6,3l-6.4-2.2l-3, -5.2l-5.2,0.4l-7.9-5.2l-2.6-9.7l-19.5,3l-5.6-4.1l-30.3,8.2l-10.1-2.6l-4.5,3l-7.9-7.1l-9,3.7l-2.6-5.6l-11.6,4.5l-13.1-6l-7.9,2.2l-9, -3l-10.1,3.4l-13.5-1.5l-13.1,5.2l-10.5,0l-2.6,3l-1.9,18.7l3.7,6l-3.7,15.7l3.4,7.1l-9,3.7l3,7.1l-4.9,9.4l-7.9,1.5l-4.5,11.2l6.7,5.2l-10.5,9.7l-8.2-3l-3.7,7.9l-5.2,1.9l1.9,7.5l-7.9,2.2l-6.4,16.5l4.5,7.9l-6.4,26.9l-4.5,17.6l4.1,3.7l-0.7,28.5l12.4,12l-0.4,6.7l6.4,5.2l3.7,13.5l10.1,9.7l2.6,9.4l15.7,1.1l11.2,11.6l11.2,5.6l17.6,2.2l5.2,8.2l8.2,-0.4l-3,12l11.2,4.5l13.5,-0.4l10.5,3.7l5.2,16.1l15.3,4.1l14.6,7.1l7.1,5.6l11.2-3.7l24.7,5.2l15,13.1l14.2,4.1l15.3,8.6l5.2,10.5l7.9,1.9l7.9-3l16.1,7.1l11.6,3l2.6,6.4l16.8,2.2l15,24l18.3,7.1l6.7,16.5l6.4,3l8.6,20.2l27.3,15.7l8.6,12l4.5,10.5l6.4-1.1l4.5-10.1l18.7-4.1l8.2-11.6l11.6,5.6l4.5-8.6l3.4-14.2l8.6,3.4l10.5-14.2l1.1-12.4l26.6-0.4l9-6.4l1.5-8.2l13.5,3.4l12.7-5.6l8.6-0.7l17.2-9.4l11.6,0l16.8-4.9l6.7,6l7.1-2.2l6.7,6l13.9-2.6l10.5,0.7l4.9,4.5l10.1,22.8l7.1,7.1l-4.1,9.7l7.1,13.9l10.1,4.5l4.1,16.5l6.7-1.1l1.5,5.6l6.7-0.7l4.1,8.2l-0.4,8.6l4.5,2.2l6.4-6l1.1-7.5l9.7-4.5l2.2-12.7l7.5-4.9l3.4-10.9l-6.7-10.9l6-9.7l0.7-12l-2.6-8.6l5.6-4.9l1.1-11.2l4.9-5.6l11.6-3.7l10.9-14.2l4.5-2.2l-0.7-15.7l6.7-6.4l2.2-10.1l8.6-3.4l4.5-9.4l9.7-2.6l3.4-9.7l6.7-5.6l13.9,12.7l-6,7.9l9,8.6l2.2,7.1l0,12l4.5,12l-6.4,7.9l5.6,6.4l10.5,14.2l-3.7,4.9l-1.5,13.5l6.7,2.6l-5.2,14.9l5.6,4.1l-2.6,7.1l-5.2,2.6l4.1,18.4l6.7-4.5l3.4-7.1l5.2,0.4l6.7-5.6l-3.4-9.4l9-4.5l-1.9-12l4.9-3.7l2.2-9.4l10.5-3.7l6.7-9.7l1.9-10.1l-4.5-6.4l3.7-10.1l-8.6-3.7l-4.1-16.1l12-12l0.7-13.5l-6.4-7.5l2.2-6.7l-5.2-2.6l4.1-20.2l-9.4-4.1l3.4-7.1l-5.2-3l-2.6,4.1l-6.7-7.9l-9-15.7l3.7-2.2l-6-20.2l-6.7-1.9l-4.9-5.2L861.1,186l5.6-22.5L882,152.2l-1.5-8.2l13.5-17.2l2.2-13.9l9.4-2.2l0-9l9-7.1l2.6-7.9l9.7-10.5l12.4,0.4l2.6-5.6l-11.6-7.9l6.4-20.2L935.5,59.6z";
        
        const path2D = new Path2D(usPathData);

        // Coordinate Mapping: LA in this specific SVG path coordinate space (960x600)
        const LA_COORDS = { x: 72, y: 365 }; 
        const PX_PER_MILE = 960 / CONFIG.usWidthMiles; // approx 0.34 px/mile

        function calculateFutureYear(targetPop) {
            // Growth Formula: t = ln(P / P0) / ln(1 + r)
            const yearsNeeded = Math.log(targetPop / CONFIG.initialPop) / Math.log(1 + CONFIG.growthRate);
            return Math.round(CONFIG.startYear + yearsNeeded);
        }

        function formatNumber(num) {
            if (num >= 1e12) return (num / 1e12).toFixed(2) + " Trillion";
            if (num >= 1e9) return (num / 1e9).toFixed(2) + " Billion";
            return num.toLocaleString();
        }

        function draw() {
            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. Draw US Base
            ctx.fillStyle = '#1e293b'; // Matches panel bg, looks like "empty space"
            ctx.strokeStyle = '#475569'; // Slate 600
            ctx.lineWidth = 2;
            ctx.stroke(path2D);
            ctx.fill(path2D);

            // 2. Calculate Math
            const multiplier = parseInt(slider.value);
            const currentPop = CONFIG.initialPop * multiplier;
            const currentArea = CONFIG.initialArea * multiplier;
            
            // Radius of circle = Sqrt(Area / PI)
            const radiusMiles = Math.sqrt(currentArea / Math.PI);
            const radiusPx = radiusMiles * PX_PER_MILE;

            // 3. Draw Population Blob (Clipped to US Shape)
            ctx.save();
            ctx.clip(path2D); // The magic: Masking the circle to the map border

            // Radial Gradient from LA
            const gradient = ctx.createRadialGradient(
                LA_COORDS.x, LA_COORDS.y, 0, 
                LA_COORDS.x, LA_COORDS.y, radiusPx
            );
            
            // Heatmap colors: Super dense core (Red) -> Spreading edge (Gold)
            gradient.addColorStop(0, 'rgba(244, 63, 94, 1)');   // Red 500
            gradient.addColorStop(0.6, 'rgba(234, 179, 8, 0.8)'); // Yellow 500
            gradient.addColorStop(1, 'rgba(56, 189, 248, 0.6)');  // Sky 400

            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(LA_COORDS.x, LA_COORDS.y, radiusPx, 0, Math.PI * 2);
            ctx.fill();

            // Draw a subtle "Frontier" line
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(LA_COORDS.x, LA_COORDS.y, radiusPx, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.restore();

            // 4. Draw Start Point (LA)
            ctx.beginPath();
            ctx.arc(LA_COORDS.x, LA_COORDS.y, 4, 0, Math.PI*2);
            ctx.fillStyle = '#38bdf8'; // Accent Blue
            ctx.fill();
            ctx.lineWidth = 1;
            ctx.strokeStyle = '#fff';
            ctx.stroke();

            // 5. Update Stats
            ui.pop.innerText = formatNumber(currentPop);
            ui.area.innerText = Math.round(currentArea).toLocaleString() + " sq mi";
            
            const pct = (currentArea / CONFIG.usLandArea) * 100;
            ui.coverage.innerText = pct < 0.01 ? "< 0.01%" : pct.toFixed(2) + "%";

            const futureYear = calculateFutureYear(currentPop);
            ui.year.innerText = futureYear.toLocaleString().replace(/,/g, ''); // Remove commas for years
        }

        // Event Listeners
        slider.addEventListener('input', draw);
        window.addEventListener('resize', draw);

        // Init
        draw();

    </script>
</body>
</html>